crystal_doc_search_index_callback({"repository_name":"shellyplug-exporter","body":"![](.github/images/shelly_plug_s.png)\n\n# shellyplug-exporter (v2.0.1)\n\n![GitHub Workflow Status (main)](https://github.com/d1ceward/shellyplug-exporter/actions/workflows/main.yml/badge.svg?branch=master)\n[![Docker Pulls](https://img.shields.io/docker/pulls/d1ceward/shellyplug-exporter.svg?logo=docker)](https://hub.docker.com/r/d1ceward/shellyplug-exporter)\n[![GHCR](https://img.shields.io/badge/GHCR-Available-blue?logo=github)](https://github.com/users/d1ceward/packages/container/package/shellyplug-exporter)\n[![GitHub issues](https://img.shields.io/github/issues/d1ceward/shellyplug-exporter)](https://github.com/d1ceward/shellyplug-exporter/issues)\n[![GitHub license](https://img.shields.io/github/license/d1ceward/shellyplug-exporter)](https://github.com/d1ceward/shellyplug-exporter/blob/master/LICENSE)\n\n**Prometheus exporter for Shelly Plug S, written in Crystal.**\n> **Note** Uses the plug’s HTTP API (not MQTT).\n\n:rocket: Feature requests and suggestions are welcome, open an issue!\n\n## Quick Start\n\n### 1. YAML Configuration (Recommended)\n\nManage multiple plugs easily with a `config.yaml` file.\n\n**Create `config.yaml`:**\n```yaml\nexporter_port: 5000\nplugs:\n  - name: plug1\n    host: 192.168.33.2\n    port: 80\n    auth_username: user1\n    auth_password: pass1\n  - name: plug2\n    host: 192.168.33.3\n    port: 80\n    auth_username: user2\n    auth_password: pass2\n```\n\n**Run the exporter:**\n```shell\nshellyplug-exporter run --config config.yaml\n```\n\n### 2. Environment Variables (Legacy, Single Plug)\n\nSet variables for a single plug:\n\n- `SHELLYPLUG_HOST` (required)\n- `SHELLYPLUG_PORT` (default: 80)\n- `SHELLYPLUG_AUTH_USERNAME` / `SHELLYPLUG_AUTH_PASSWORD` (if needed)\n- `EXPORTER_PORT` (default: 5000)\n\n**Example:**\n```shell\nshellyplug-exporter run --port 5000\n```\n\n---\n\n### 3. Docker Usage\n\n**With `config.yaml`:**\n```shell\ndocker run -d \\\n  -p 8080:5000 \\\n  -v $(pwd)/config.yaml:/config.yaml \\\n  ghcr.io/d1ceward/shellyplug-exporter:latest \\\n  shellyplug-exporter run --config /config.yaml\n```\n\n**docker-compose:**\n```yaml\nservices:\n  plug_exporter:\n    image: ghcr.io/d1ceward/shellyplug-exporter:latest\n    restart: unless-stopped\n    ports:\n      - 8080:5000\n    volumes:\n      - ./config.yaml:/config.yaml\n    command: shellyplug-exporter run --config /config.yaml\n```\n\n**With environment variables:**\n```shell\ndocker run -d \\\n  -p 8080:5000 \\\n  -e SHELLYPLUG_HOST=\"shelly-plug-hostname-or-ip\" \\\n  -e SHELLYPLUG_PORT=\"80\" \\\n  -e SHELLYPLUG_AUTH_USERNAME=\"username\" \\\n  -e SHELLYPLUG_AUTH_PASSWORD=\"password\" \\\n  -e EXPORTER_PORT=5000 \\\n  ghcr.io/d1ceward/shellyplug-exporter:latest\n```\n\n### 4. Linux Binary\n\n**Download:**\n```shell\nwget --no-verbose -O shellyplug-exporter https://github.com/d1ceward/shellyplug-exporter/releases/download/v2.0.1/shellyplug-exporter-linux-amd64\nchmod +x shellyplug-exporter\n```\n\n**Run:**\n```shell\nshellyplug-exporter run --port 5000\n```\n\n\n## Metrics\n\n**Endpoint:** `/metrics`\n\n| Name                   | Description                          | Type    |\n|------------------------|--------------------------------------|---------|\n| shellyplug_power       | Current power drawn (watts)          | Gauge   |\n| shellyplug_overpower   | Overpower drawn (watts)              | Gauge   |\n| shellyplug_total       | Total power consumed (watt-minutes)  | Counter |\n| shellyplug_temperature | Plug temperature (°C)                | Gauge   |\n| shellyplug_uptime      | Plug uptime (seconds)                | Gauge   |\n\n**Multiple plugs:**\nMetrics include a `plug` label:\n```\nshellyplug_power{plug=\"plug1\"} 12.3\nshellyplug_power{plug=\"plug2\"} 8.7\n```\n\n## Contributing\n\nBug reports and pull requests are welcome!\nBy contributing, you agree to the Code of Merit.\n\n1. Fork: [github.com/d1ceward/shellyplug-exporter](https://github.com/d1ceward/shellyplug-exporter/fork)\n2. Create a branch: `git checkout -b my-new-feature`\n3. Commit: `git commit -am 'Add some feature'`\n4. Push: `git push origin my-new-feature`\n5. Open a Pull Request\n\n## Development\n\n1. Install Crystal (see `.crystal-version`)\n2. Install dependencies: `shards install`\n3. Build: `shards build`\n4. Binary: `bin/shellyplug-exporter`\n\n**Run tests:**\n```shell\ncrystal spec\n```\n\n## Documentation\n\nSee: [d1ceward.github.io/shellyplug-exporter](https://d1ceward.github.io/shellyplug-exporter/)\n\n## Contributors\n\n- [d1ceward](https://github.com/d1ceward) – creator and maintainer\n","program":{"html_id":"shellyplug-exporter/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"shellyplug-exporter","program":true,"enum":false,"alias":false,"const":false,"types":[{"html_id":"shellyplug-exporter/ShellyplugExporter","path":"ShellyplugExporter.html","kind":"module","full_name":"ShellyplugExporter","name":"ShellyplugExporter","abstract":false,"locations":[{"filename":"src/shellyplug_exporter/cli.cr","line_number":1,"url":null},{"filename":"src/shellyplug_exporter/config.cr","line_number":1,"url":null},{"filename":"src/shellyplug_exporter/plug.cr","line_number":1,"url":null},{"filename":"src/shellyplug_exporter/plug_client.cr","line_number":1,"url":null},{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":1,"url":null},{"filename":"src/shellyplug_exporter/server.cr","line_number":1,"url":null},{"filename":"src/version.cr","line_number":1,"url":null}],"repository_name":"shellyplug-exporter","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"VERSION","name":"VERSION","value":"\"2.0.1\""}],"types":[{"html_id":"shellyplug-exporter/ShellyplugExporter/CLI","path":"ShellyplugExporter/CLI.html","kind":"class","full_name":"ShellyplugExporter::CLI","name":"CLI","abstract":false,"superclass":{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"shellyplug-exporter/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/shellyplug_exporter/cli.cr","line_number":3,"url":null}],"repository_name":"shellyplug-exporter","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"shellyplug-exporter/ShellyplugExporter","kind":"module","full_name":"ShellyplugExporter","name":"ShellyplugExporter"},"doc":"CLI class handles command line interface interactions for the exporter.","summary":"<p>CLI class handles command line interface interactions for the exporter.</p>","constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/shellyplug_exporter/cli.cr","line_number":8,"url":null},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"config_path:String|Nil-instance-method","name":"config_path","abstract":false,"location":{"filename":"src/shellyplug_exporter/cli.cr","line_number":4,"url":null},"def":{"name":"config_path","return_type":"String | ::Nil","visibility":"Public","body":"@config_path"},"external_var":false},{"html_id":"config_path=(config_path:String|Nil)-instance-method","name":"config_path=","abstract":false,"args":[{"name":"config_path","external_name":"config_path","restriction":"String | ::Nil"}],"args_string":"(config_path : String | Nil)","args_html":"(config_path : String | Nil)","location":{"filename":"src/shellyplug_exporter/cli.cr","line_number":4,"url":null},"def":{"name":"config_path=","args":[{"name":"config_path","external_name":"config_path","restriction":"String | ::Nil"}],"visibility":"Public","body":"@config_path = config_path"},"external_var":false},{"html_id":"exporter_port:Int32|Nil-instance-method","name":"exporter_port","abstract":false,"location":{"filename":"src/shellyplug_exporter/cli.cr","line_number":5,"url":null},"def":{"name":"exporter_port","return_type":"Int32 | ::Nil","visibility":"Public","body":"@exporter_port"},"external_var":false},{"html_id":"exporter_port=(exporter_port:Int32|Nil)-instance-method","name":"exporter_port=","abstract":false,"args":[{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32 | ::Nil"}],"args_string":"(exporter_port : Int32 | Nil)","args_html":"(exporter_port : Int32 | Nil)","location":{"filename":"src/shellyplug_exporter/cli.cr","line_number":5,"url":null},"def":{"name":"exporter_port=","args":[{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32 | ::Nil"}],"visibility":"Public","body":"@exporter_port = exporter_port"},"external_var":false},{"html_id":"run_server=(run_server:Bool)-instance-method","name":"run_server=","abstract":false,"args":[{"name":"run_server","external_name":"run_server","restriction":"Bool"}],"args_string":"(run_server : Bool)","args_html":"(run_server : Bool)","location":{"filename":"src/shellyplug_exporter/cli.cr","line_number":6,"url":null},"def":{"name":"run_server=","args":[{"name":"run_server","external_name":"run_server","restriction":"Bool"}],"visibility":"Public","body":"@run_server = run_server"},"external_var":false},{"html_id":"run_server?:Bool-instance-method","name":"run_server?","abstract":false,"location":{"filename":"src/shellyplug_exporter/cli.cr","line_number":6,"url":null},"def":{"name":"run_server?","return_type":"Bool","visibility":"Public","body":"@run_server"},"external_var":false}]},{"html_id":"shellyplug-exporter/ShellyplugExporter/Config","path":"ShellyplugExporter/Config.html","kind":"class","full_name":"ShellyplugExporter::Config","name":"Config","abstract":false,"superclass":{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"shellyplug-exporter/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/shellyplug_exporter/config.cr","line_number":3,"url":null}],"repository_name":"shellyplug-exporter","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"shellyplug-exporter/ShellyplugExporter","kind":"module","full_name":"ShellyplugExporter","name":"ShellyplugExporter"},"doc":"Represents the exporter configuration, supporting multiple plugs.","summary":"<p>Represents the exporter configuration, supporting multiple plugs.</p>","constructors":[{"html_id":"load(yaml_path:String|Nil=nil):self-class-method","name":"load","doc":"Loads configuration from a YAML file or environment variables.","summary":"<p>Loads configuration from a YAML file or environment variables.</p>","abstract":false,"args":[{"name":"yaml_path","default_value":"nil","external_name":"yaml_path","restriction":"String | ::Nil"}],"args_string":"(yaml_path : String | Nil = nil) : self","args_html":"(yaml_path : String | Nil = <span class=\"n\">nil</span>) : <span class=\"k\">self</span>","location":{"filename":"src/shellyplug_exporter/config.cr","line_number":10,"url":null},"def":{"name":"load","args":[{"name":"yaml_path","default_value":"nil","external_name":"yaml_path","restriction":"String | ::Nil"}],"return_type":"self","visibility":"Public","body":"yaml_path ? load_from_yaml(yaml_path) : load_from_env"},"external_var":false},{"html_id":"new(exporter_port:Int32,plugs:Array(PlugConfig))-class-method","name":"new","abstract":false,"args":[{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32"},{"name":"plugs","external_name":"plugs","restriction":"Array(PlugConfig)"}],"args_string":"(exporter_port : Int32, plugs : Array(PlugConfig))","args_html":"(exporter_port : Int32, plugs : Array(<a href=\"../ShellyplugExporter/PlugConfig.html\">PlugConfig</a>))","location":{"filename":"src/shellyplug_exporter/config.cr","line_number":7,"url":null},"def":{"name":"new","args":[{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32"},{"name":"plugs","external_name":"plugs","restriction":"Array(PlugConfig)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(exporter_port, plugs)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"exporter_port:Int32-instance-method","name":"exporter_port","abstract":false,"location":{"filename":"src/shellyplug_exporter/config.cr","line_number":4,"url":null},"def":{"name":"exporter_port","return_type":"Int32","visibility":"Public","body":"@exporter_port"},"external_var":false},{"html_id":"exporter_port=(exporter_port:Int32)-instance-method","name":"exporter_port=","abstract":false,"args":[{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32"}],"args_string":"(exporter_port : Int32)","args_html":"(exporter_port : Int32)","location":{"filename":"src/shellyplug_exporter/config.cr","line_number":4,"url":null},"def":{"name":"exporter_port=","args":[{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32"}],"visibility":"Public","body":"@exporter_port = exporter_port"},"external_var":false},{"html_id":"plugs:Array(PlugConfig)-instance-method","name":"plugs","abstract":false,"location":{"filename":"src/shellyplug_exporter/config.cr","line_number":5,"url":null},"def":{"name":"plugs","return_type":"Array(PlugConfig)","visibility":"Public","body":"@plugs"},"external_var":false},{"html_id":"plugs=(plugs:Array(PlugConfig))-instance-method","name":"plugs=","abstract":false,"args":[{"name":"plugs","external_name":"plugs","restriction":"Array(PlugConfig)"}],"args_string":"(plugs : Array(PlugConfig))","args_html":"(plugs : Array(<a href=\"../ShellyplugExporter/PlugConfig.html\">PlugConfig</a>))","location":{"filename":"src/shellyplug_exporter/config.cr","line_number":5,"url":null},"def":{"name":"plugs=","args":[{"name":"plugs","external_name":"plugs","restriction":"Array(PlugConfig)"}],"visibility":"Public","body":"@plugs = plugs"},"external_var":false}]},{"html_id":"shellyplug-exporter/ShellyplugExporter/Plug","path":"ShellyplugExporter/Plug.html","kind":"class","full_name":"ShellyplugExporter::Plug","name":"Plug","abstract":false,"superclass":{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"shellyplug-exporter/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/shellyplug_exporter/plug.cr","line_number":3,"url":null}],"repository_name":"shellyplug-exporter","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"shellyplug-exporter/ShellyplugExporter","kind":"module","full_name":"ShellyplugExporter","name":"ShellyplugExporter"},"doc":"Represents a Shelly plug device and provides methods to query data from it.","summary":"<p>Represents a Shelly plug device and provides methods to query data from it.</p>","constructors":[{"html_id":"new(config:PlugConfig)-class-method","name":"new","doc":"Initialize with a PlugConfig","summary":"<p>Initialize with a PlugConfig</p>","abstract":false,"args":[{"name":"config","external_name":"config","restriction":"PlugConfig"}],"args_string":"(config : PlugConfig)","args_html":"(config : <a href=\"../ShellyplugExporter/PlugConfig.html\">PlugConfig</a>)","location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":9,"url":null},"def":{"name":"new","args":[{"name":"config","external_name":"config","restriction":"PlugConfig"}],"visibility":"Public","body":"_ = allocate\n_.initialize(config)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"client:PlugClient-instance-method","name":"client","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":6,"url":null},"def":{"name":"client","return_type":"PlugClient","visibility":"Public","body":"@client"},"external_var":false},{"html_id":"client=(client:PlugClient)-instance-method","name":"client=","abstract":false,"args":[{"name":"client","external_name":"client","restriction":"PlugClient"}],"args_string":"(client : PlugClient)","args_html":"(client : <a href=\"../ShellyplugExporter/PlugClient.html\">PlugClient</a>)","location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":6,"url":null},"def":{"name":"client=","args":[{"name":"client","external_name":"client","restriction":"PlugClient"}],"visibility":"Public","body":"@client = client"},"external_var":false},{"html_id":"config:PlugConfig-instance-method","name":"config","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":5,"url":null},"def":{"name":"config","return_type":"PlugConfig","visibility":"Public","body":"@config"},"external_var":false},{"html_id":"config=(config:PlugConfig)-instance-method","name":"config=","abstract":false,"args":[{"name":"config","external_name":"config","restriction":"PlugConfig"}],"args_string":"(config : PlugConfig)","args_html":"(config : <a href=\"../ShellyplugExporter/PlugConfig.html\">PlugConfig</a>)","location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":5,"url":null},"def":{"name":"config=","args":[{"name":"config","external_name":"config","restriction":"PlugConfig"}],"visibility":"Public","body":"@config = config"},"external_var":false},{"html_id":"name:String|Nil-instance-method","name":"name","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":4,"url":null},"def":{"name":"name","return_type":"String | ::Nil","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"name=(name:String|Nil)-instance-method","name":"name=","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String | ::Nil"}],"args_string":"(name : String | Nil)","args_html":"(name : String | Nil)","location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":4,"url":null},"def":{"name":"name=","args":[{"name":"name","external_name":"name","restriction":"String | ::Nil"}],"visibility":"Public","body":"@name = name"},"external_var":false},{"html_id":"query_data:Hash(Symbol,Float64|Int64)-instance-method","name":"query_data","doc":"Queries the plug for metrics data.","summary":"<p>Queries the plug for metrics data.</p>","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug.cr","line_number":15,"url":null},"def":{"name":"query_data","return_type":"Hash(Symbol, Float64 | Int64)","visibility":"Public","body":"response = @client.fetch_status\ndata = parse_response(response)\n\nmeter = data[\"meters\"]?.try(&.[](0))\n\n{:power => meter.try(&.[]?(\"power\")).try(&.as_f?) || 0_f64, :overpower => meter.try(&.[]?(\"overpower\")).try(&.as_f?) || 0_f64, :total => meter.try(&.[]?(\"total\")).try(&.as_i64?) || 0_i64, :temperature => data[\"temperature\"]?.try(&.as_f?) || 0_f64, :uptime => data[\"uptime\"]?.try(&.as_i64?) || 0_i64}\n"},"external_var":false}]},{"html_id":"shellyplug-exporter/ShellyplugExporter/PlugClient","path":"ShellyplugExporter/PlugClient.html","kind":"class","full_name":"ShellyplugExporter::PlugClient","name":"PlugClient","abstract":false,"superclass":{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"shellyplug-exporter/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/shellyplug_exporter/plug_client.cr","line_number":3,"url":null}],"repository_name":"shellyplug-exporter","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"SETTINGS_ENDPOINT","name":"SETTINGS_ENDPOINT","value":"\"/settings\""},{"id":"STATUS_ENDPOINT","name":"STATUS_ENDPOINT","value":"\"/status\""}],"namespace":{"html_id":"shellyplug-exporter/ShellyplugExporter","kind":"module","full_name":"ShellyplugExporter","name":"ShellyplugExporter"},"doc":"Handles HTTP communication with a single Shelly plug device.","summary":"<p>Handles HTTP communication with a single Shelly plug device.</p>","constructors":[{"html_id":"new(config:PlugConfig)-class-method","name":"new","abstract":false,"args":[{"name":"config","external_name":"config","restriction":"PlugConfig"}],"args_string":"(config : PlugConfig)","args_html":"(config : <a href=\"../ShellyplugExporter/PlugConfig.html\">PlugConfig</a>)","location":{"filename":"src/shellyplug_exporter/plug_client.cr","line_number":9,"url":null},"def":{"name":"new","args":[{"name":"config","external_name":"config","restriction":"PlugConfig"}],"visibility":"Public","body":"_ = allocate\n_.initialize(config)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"fetch_settings:HTTP::Client::Response-instance-method","name":"fetch_settings","doc":"Fetches the settings from the plug.","summary":"<p>Fetches the settings from the plug.</p>","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_client.cr","line_number":17,"url":null},"def":{"name":"fetch_settings","return_type":"HTTP::Client::Response","visibility":"Public","body":"request(SETTINGS_ENDPOINT)"},"external_var":false},{"html_id":"fetch_status:HTTP::Client::Response-instance-method","name":"fetch_status","doc":"Fetches the status from the plug.","summary":"<p>Fetches the status from the plug.</p>","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_client.cr","line_number":12,"url":null},"def":{"name":"fetch_status","return_type":"HTTP::Client::Response","visibility":"Public","body":"request(STATUS_ENDPOINT)"},"external_var":false}]},{"html_id":"shellyplug-exporter/ShellyplugExporter/PlugConfig","path":"ShellyplugExporter/PlugConfig.html","kind":"class","full_name":"ShellyplugExporter::PlugConfig","name":"PlugConfig","abstract":false,"superclass":{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"shellyplug-exporter/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":3,"url":null}],"repository_name":"shellyplug-exporter","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"shellyplug-exporter/ShellyplugExporter","kind":"module","full_name":"ShellyplugExporter","name":"ShellyplugExporter"},"doc":"Represents the configuration for a single Shelly plug device.","summary":"<p>Represents the configuration for a single Shelly plug device.</p>","constructors":[{"html_id":"new(name:String,host:String,port:Int32,auth_username:String|Nil=nil,auth_password:String|Nil=nil,last_request_succeeded:Bool|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"host","external_name":"host","restriction":"String"},{"name":"port","external_name":"port","restriction":"Int32"},{"name":"auth_username","default_value":"nil","external_name":"auth_username","restriction":"String | ::Nil"},{"name":"auth_password","default_value":"nil","external_name":"auth_password","restriction":"String | ::Nil"},{"name":"last_request_succeeded","default_value":"nil","external_name":"last_request_succeeded","restriction":"Bool | ::Nil"}],"args_string":"(name : String, host : String, port : Int32, auth_username : String | Nil = nil, auth_password : String | Nil = nil, last_request_succeeded : Bool | Nil = nil)","args_html":"(name : String, host : String, port : Int32, auth_username : String | Nil = <span class=\"n\">nil</span>, auth_password : String | Nil = <span class=\"n\">nil</span>, last_request_succeeded : Bool | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":11,"url":null},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"host","external_name":"host","restriction":"String"},{"name":"port","external_name":"port","restriction":"Int32"},{"name":"auth_username","default_value":"nil","external_name":"auth_username","restriction":"String | ::Nil"},{"name":"auth_password","default_value":"nil","external_name":"auth_password","restriction":"String | ::Nil"},{"name":"last_request_succeeded","default_value":"nil","external_name":"last_request_succeeded","restriction":"Bool | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, host, port, auth_username, auth_password, last_request_succeeded)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"auth_password:String|Nil-instance-method","name":"auth_password","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":8,"url":null},"def":{"name":"auth_password","return_type":"String | ::Nil","visibility":"Public","body":"@auth_password"},"external_var":false},{"html_id":"auth_password=(auth_password:String|Nil)-instance-method","name":"auth_password=","abstract":false,"args":[{"name":"auth_password","external_name":"auth_password","restriction":"String | ::Nil"}],"args_string":"(auth_password : String | Nil)","args_html":"(auth_password : String | Nil)","location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":8,"url":null},"def":{"name":"auth_password=","args":[{"name":"auth_password","external_name":"auth_password","restriction":"String | ::Nil"}],"visibility":"Public","body":"@auth_password = auth_password"},"external_var":false},{"html_id":"auth_username:String|Nil-instance-method","name":"auth_username","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":7,"url":null},"def":{"name":"auth_username","return_type":"String | ::Nil","visibility":"Public","body":"@auth_username"},"external_var":false},{"html_id":"auth_username=(auth_username:String|Nil)-instance-method","name":"auth_username=","abstract":false,"args":[{"name":"auth_username","external_name":"auth_username","restriction":"String | ::Nil"}],"args_string":"(auth_username : String | Nil)","args_html":"(auth_username : String | Nil)","location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":7,"url":null},"def":{"name":"auth_username=","args":[{"name":"auth_username","external_name":"auth_username","restriction":"String | ::Nil"}],"visibility":"Public","body":"@auth_username = auth_username"},"external_var":false},{"html_id":"host:String-instance-method","name":"host","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":5,"url":null},"def":{"name":"host","return_type":"String","visibility":"Public","body":"@host"},"external_var":false},{"html_id":"host=(host:String)-instance-method","name":"host=","abstract":false,"args":[{"name":"host","external_name":"host","restriction":"String"}],"args_string":"(host : String)","args_html":"(host : String)","location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":5,"url":null},"def":{"name":"host=","args":[{"name":"host","external_name":"host","restriction":"String"}],"visibility":"Public","body":"@host = host"},"external_var":false},{"html_id":"last_request_succeeded:Bool|Nil-instance-method","name":"last_request_succeeded","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":9,"url":null},"def":{"name":"last_request_succeeded","return_type":"Bool | ::Nil","visibility":"Public","body":"@last_request_succeeded"},"external_var":false},{"html_id":"last_request_succeeded=(last_request_succeeded:Bool|Nil)-instance-method","name":"last_request_succeeded=","abstract":false,"args":[{"name":"last_request_succeeded","external_name":"last_request_succeeded","restriction":"Bool | ::Nil"}],"args_string":"(last_request_succeeded : Bool | Nil)","args_html":"(last_request_succeeded : Bool | Nil)","location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":9,"url":null},"def":{"name":"last_request_succeeded=","args":[{"name":"last_request_succeeded","external_name":"last_request_succeeded","restriction":"Bool | ::Nil"}],"visibility":"Public","body":"@last_request_succeeded = last_request_succeeded"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":4,"url":null},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"name=(name:String)-instance-method","name":"name=","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":4,"url":null},"def":{"name":"name=","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"@name = name"},"external_var":false},{"html_id":"port:Int32-instance-method","name":"port","abstract":false,"location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":6,"url":null},"def":{"name":"port","return_type":"Int32","visibility":"Public","body":"@port"},"external_var":false},{"html_id":"port=(port:Int32)-instance-method","name":"port=","abstract":false,"args":[{"name":"port","external_name":"port","restriction":"Int32"}],"args_string":"(port : Int32)","args_html":"(port : Int32)","location":{"filename":"src/shellyplug_exporter/plug_config.cr","line_number":6,"url":null},"def":{"name":"port=","args":[{"name":"port","external_name":"port","restriction":"Int32"}],"visibility":"Public","body":"@port = port"},"external_var":false}]},{"html_id":"shellyplug-exporter/ShellyplugExporter/Server","path":"ShellyplugExporter/Server.html","kind":"class","full_name":"ShellyplugExporter::Server","name":"Server","abstract":false,"superclass":{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"shellyplug-exporter/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"shellyplug-exporter/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/shellyplug_exporter/server.cr","line_number":3,"url":null}],"repository_name":"shellyplug-exporter","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"shellyplug-exporter/ShellyplugExporter","kind":"module","full_name":"ShellyplugExporter","name":"ShellyplugExporter"},"doc":"HTTP server for Prometheus metrics for one or more Shelly plugs.","summary":"<p>HTTP server for Prometheus metrics for one or more Shelly plugs.</p>","constructors":[{"html_id":"new(plugs:Array(Plug),exporter_port:Int32)-class-method","name":"new","abstract":false,"args":[{"name":"plugs","external_name":"plugs","restriction":"Array(Plug)"},{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32"}],"args_string":"(plugs : Array(Plug), exporter_port : Int32)","args_html":"(plugs : Array(<a href=\"../ShellyplugExporter/Plug.html\">Plug</a>), exporter_port : Int32)","location":{"filename":"src/shellyplug_exporter/server.cr","line_number":8,"url":null},"def":{"name":"new","args":[{"name":"plugs","external_name":"plugs","restriction":"Array(Plug)"},{"name":"exporter_port","external_name":"exporter_port","restriction":"Int32"}],"visibility":"Public","body":"_ = allocate\n_.initialize(plugs, exporter_port)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"run:Nil-instance-method","name":"run","abstract":false,"location":{"filename":"src/shellyplug_exporter/server.cr","line_number":19,"url":null},"def":{"name":"run","return_type":"Nil","visibility":"Public","body":"Log.info do \"Metrics server listening on http://0.0.0.0:#{@exporter_port}.\" end\n@server.listen\n"},"external_var":false},{"html_id":"stop:Nil-instance-method","name":"stop","abstract":false,"location":{"filename":"src/shellyplug_exporter/server.cr","line_number":24,"url":null},"def":{"name":"stop","return_type":"Nil","visibility":"Public","body":"Log.info do \"Stopping metrics server.\" end\n@server.close\n"},"external_var":false}]}]}]}})